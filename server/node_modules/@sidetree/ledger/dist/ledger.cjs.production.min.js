"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@sidetree/test-vectors"),t=require("../package.json").version,r=function(){function e(){var e=this;this.hashes=[],this.latestTime={time:0,hash:""},this.getLatestTime=function(){return e.latestTime={time:5e5,hash:"dummyHash"},Promise.resolve(e.latestTime)}}var r,n=e.prototype;return n.getServiceVersion=function(){try{return Promise.resolve({name:"mock-ledger",version:t})}catch(e){return Promise.reject(e)}},n.initialize=function(){return Promise.resolve()},n.getFee=function(e){throw new Error("Method not implemented.")},n.getValueTimeLock=function(e){throw new Error("Method not implemented.")},n.getWriterValueTimeLock=function(){throw new Error("Method not implemented.")},n.write=function(e,t){try{return this.hashes.push([e]),Promise.resolve()}catch(e){return Promise.reject(e)}},n.read=function(e,t){try{var r=this.hashes.map((function(e,t){return{transactionNumber:t,transactionTime:t,transactionHash:e[0],transactionTimeHash:e[0],anchorString:e[0],writer:"writer",transactionFeePaid:0,normalizedTransactionFee:0}}));return e?r=r.filter((function(t){return t.transactionNumber>=e})):t&&(r=r.filter((function(e){return e.transactionTimeHash===t}))),Promise.resolve({moreTransactions:!1,transactions:r})}catch(e){return Promise.reject(e)}},n.getFirstValidTransaction=function(e){return Promise.resolve(void 0)},n.setLatestTime=function(e){this.latestTime=e},(r=[{key:"approximateTime",get:function(){return this.latestTime}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,r),e}(),n=e.filesystem.anchorFile,o=n.anchorString,i=n.anchorString2,s=n.anchorString3;jest.setTimeout(1e4),exports.MockLedger=r,exports.testSuite=function(e){describe(e.constructor.name,(function(){beforeAll((function(){try{return Promise.resolve(e.initialize()).then((function(){}))}catch(e){return Promise.reject(e)}})),describe("getServiceVersion",(function(){it("should get service version",(function(){try{return Promise.resolve(e.getServiceVersion()).then((function(e){expect(e).toBeDefined(),expect(e.name).toBeDefined(),expect(e.version).toBeDefined()}))}catch(e){return Promise.reject(e)}}))})),describe("write",(function(){it("should write to the ledger",(function(){try{return Promise.resolve(e.write(o,0)).then((function(){}))}catch(e){return Promise.reject(e)}}))})),describe("getApproximateTime",(function(){it("should get latest cached blockchain time",(function(){try{return Promise.resolve(e.getLatestTime()).then((function(t){return Promise.resolve(e.approximateTime).then((function(e){expect(e.time).toBe(t.time),expect(e.hash).toBe(t.hash)}))}))}catch(e){return Promise.reject(e)}}))})),describe("read",(function(){var t,r;it("should get all transactions",(function(){try{return Promise.resolve(e.read()).then((function(n){return expect(n.moreTransactions).toBeFalsy(),expect(n.transactions).toHaveLength(1),expect(n.transactions[0].transactionNumber).toBe(0),expect(n.transactions[0].transactionTime).toBeDefined(),expect(n.transactions[0].transactionTimeHash).toBeDefined(),expect(n.transactions[0].anchorString).toBe(o),expect(n.transactions[0].writer).toBeDefined(),t=n.transactions[0].transactionTimeHash,Promise.resolve(e.write(i,0)).then((function(){return Promise.resolve(e.read()).then((function(e){expect(e.moreTransactions).toBeFalsy(),expect(e.transactions).toHaveLength(2),expect(e.transactions[0].anchorString).toBe(o),expect(e.transactions[1].anchorString).toBe(i),r=e.transactions[1].transactionNumber}))}))}))}catch(e){return Promise.reject(e)}})),it("should get a specific transaction",(function(){try{return Promise.resolve(e.read(void 0,t)).then((function(e){expect(e.moreTransactions).toBeFalsy(),expect(e.transactions).toHaveLength(1),expect(e.transactions[0].transactionTimeHash).toBe(t),expect(e.transactions[0].anchorString).toBe(o)}))}catch(e){return Promise.reject(e)}})),it("should get all transactions since a block",(function(){try{return Promise.resolve(e.write(s,0)).then((function(){return Promise.resolve(e.read(r)).then((function(e){expect(e.moreTransactions).toBeFalsy(),expect(e.transactions).toHaveLength(2),expect(e.transactions[0].transactionNumber).toBe(r),expect(e.transactions[1].transactionNumber).toBe(r+1),expect(e.transactions[0].anchorString).toBe(i),expect(e.transactions[1].anchorString).toBe(s)}))}))}catch(e){return Promise.reject(e)}})),it("should return no transaction if the requested transactionNumber doesnt exist",(function(){try{return Promise.resolve(e.read(3)).then((function(e){expect(e.moreTransactions).toBeFalsy(),expect(e.transactions).toHaveLength(0)}))}catch(e){return Promise.reject(e)}})),it("should return no transaction if the requested transactionTimeHash doesnt exist",(function(){try{return Promise.resolve(e.read(void 0,"0x123")).then((function(e){expect(e.moreTransactions).toBeFalsy(),expect(e.transactions).toHaveLength(0)}))}catch(e){return Promise.reject(e)}}))}))}))};
//# sourceMappingURL=ledger.cjs.production.min.js.map

"use strict";var e=require("@sidetree/common"),r=function(){function r(){}return r.computeMinimumTransactionFee=function(r,o){if(o<=0)throw new e.SidetreeError(e.ErrorCode.OperationCountLessThanZero,"Fee cannot be calculated for the given number of operations: "+o);return Math.max(r*e.protocolParameters.normalizedFeeToPerOperationFeeMultiplier*o,r)},r.verifyTransactionFeeAndThrowOnError=function(r,o,a){if(o<=0)throw new e.SidetreeError(e.ErrorCode.OperationCountLessThanZero,"The number of operations: "+o+" must be greater than 0");if(r<a)throw new e.SidetreeError(e.ErrorCode.TransactionFeePaidLessThanNormalizedFee,"The actual fee paid: "+r+" should be greater than or equal to the normalized fee: "+a);var t=a*e.protocolParameters.normalizedFeeToPerOperationFeeMultiplier;if(r/o<t)throw new e.SidetreeError(e.ErrorCode.TransactionFeePaidInvalid,"The actual fee paid: "+r+" per number of operations: "+o+" should be at least "+t+".")},r}(),o=function(){function r(){}return r.calculateMaxNumberOfOperationsAllowed=function(r,o){if(void 0===r)return e.protocolParameters.maxNumberOfOperationsForNoValueTimeLock;var a=o.getVersionMetadata(r.lockTransactionTime),t=Math.floor(r.amountLocked/(r.normalizedFee*a.normalizedFeeToPerOperationFeeMultiplier*a.valueTimeLockAmountMultiplier));return Math.max(t,e.protocolParameters.maxNumberOfOperationsForNoValueTimeLock)},r.verifyLockAmountAndThrowOnError=function(r,o,a,t,i){if(!(o<=e.protocolParameters.maxNumberOfOperationsForNoValueTimeLock)){if(r){if(r.owner!==t)throw new e.SidetreeError(e.ErrorCode.ValueTimeLockVerifierTransactionWriterLockOwnerMismatch,"Sidetree transaction writer: "+t+" - Lock owner: "+r.owner);if(a<r.lockTransactionTime||a>=r.unlockTransactionTime)throw new e.SidetreeError(e.ErrorCode.ValueTimeLockVerifierTransactionTimeOutsideLockRange,"Sidetree transaction block: "+a+"; lock start time: "+r.lockTransactionTime+"; unlock time: "+r.unlockTransactionTime)}var n=this.calculateMaxNumberOfOperationsAllowed(r,i);if(o>n)throw new e.SidetreeError(e.ErrorCode.ValueTimeLockVerifierInvalidNumberOfOperations,"Max number of ops allowed: "+n+"; actual number of ops: "+o)}},r}();exports.FeeManager=r,exports.ValueTimeLockVerifier=o;
//# sourceMappingURL=ValueTimeLockVerifier-849c26c7.js.map

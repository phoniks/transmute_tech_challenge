"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,o,n=(e=require("base64url"))&&"object"==typeof e&&"default"in e?e.default:e,r=require("crypto");!function(e){e.CasNotReachable="cas_not_reachable",e.InvalidHash="content_hash_invalid",e.MaxSizeExceeded="content_exceeds_maximum_allowed_size",e.MaxSizeNotSpecified="content_max_size_not_specified",e.NotAFile="content_not_a_file",e.NotFound="content_not_found",e.Success="success"}(o||(o={}));var t,i=o;!function(e){e.Create="create",e.Update="update",e.Deactivate="deactivate",e.Recover="recover"}(t||(t={}));var a,_=t;!function(e){e.Auth="auth",e.General="general",e.KeyAgreement="agreement",e.AssertionMethod="assertion",e.CapabilityDelegation="delegation",e.CapabilityInvocation="invocation"}(a||(a={}));var s,c=a;!function(e){e.BadRequest="bad-request",e.NotFound="not-found",e.ServerError="server-error",e.Succeeded="succeeded"}(s||(s={}));var p,u=s;!function(e){e.Pending="pending",e.Processed="processed"}(p||(p={}));var d=p,l={AnchoredDataIncorrectFormat:"anchored_data_incorrect_format",AnchoredDataNumberOfOperationsGreaterThanMax:"anchored_data_number_of_operations_greater_than_max",AnchoredDataNumberOfOperationsNotPositiveInteger:"anchored_data_number_of_operations_not_positive_integer",AnchorFileCreatePropertyNotArray:"anchor_file_create_property_not_array",AnchorFileDecompressionFailure:"anchor_file_decompression_failed",AnchorFileHasUnknownProperty:"anchor_file_has_unknown_property",AnchorFileMapFileHashMissing:"anchor_file_map_file_hash_missing",AnchorFileMapFileHashNotString:"anchor_file_map_file_hash_not_string",AnchorFileMapFileHashUnsupported:"anchor_file_map_file_hash_unsupported",AnchorFileMissingOperationsProperty:"anchor_file_did_unique_suffixes_missing",AnchorFileMultipleOperationsForTheSameDid:"anchor_file_multiple_operations_for_the_same_did",AnchorFileNotJson:"anchor_file_not_json",AnchorFileOperationCountExceededPaidLimit:"anchor_file_operation_count_exceeded_paid_limit",AnchorFileRecoverPropertyNotArray:"anchor_file_recover_property_not_array",AnchorFileDeactivatePropertyNotArray:"anchor_file_deactivate_property_not_array",AnchorFileUnexpectedPropertyInOperations:"anchor_file_unexpected_property_in_operations",AnchorFileWriterLockIPropertyNotString:"anchor_file_writer_lock_id_property_not_string",BatchWriterAlreadyHasOperationForDid:"batch_writer_already_has_operation_for_did",CasFileHashNotValid:"cas_file_hash_not_valid",CasFileNotAFile:"cas_file_not_a file",CasFileNotFound:"cas_file_not_found",CasFileTooLarge:"cas_file_too_large",CasNotReachable:"cas_not_reachable",ChunkFileDeltaSizeExceedsLimit:"chunk_file_delta_size_exceeds_limit",ChunkFileDeltasNotArrayOfStrings:"chunk_file_deltas_not_array_of_string",ChunkFileDeltasPropertyNotArray:"chunk_file_deltas_property_not_array",ChunkFileUnexpectedProperty:"chunk_file_unexpected_property",CreateOperationMissingOrUnknownProperty:"create_operation_missing_or_unknown_property",CreateOperationSuffixDataMissingOrNotString:"create_operation_suffix_data_missing_or_not_string",CreateOperationSuffixDataMissingOrUnknownProperty:"create_operation_suffix_data_missing_or_unknown_property",CreateOperationTypeIncorrect:"create_operation_type_incorrect",DeltaMissingOrNotString:"delta_missting_or_not_string",DeltaMissingOrUnknownProperty:"delta_missing_or_unknown_property",DidIncorrectPrefix:"did_incorrect_prefix",DidInitialStateValueContainsMoreThanOneDot:"did_initial_state_value_contains_more_than_one_dot",DidInitialStateValueContainsNoDot:"did_initial_state_value_contains_no_dot",DidInitialStateValueDoesNotContainTwoParts:"did_initial_state_value_does_not_contain_two_parts",DidInvalidDidString:"did_invalid_did_string",DidLongFormNoInitialStateFound:"did_long_form_no_initial_state_found",DidLongFormOnlyInitialStateParameterIsAllowed:"did_long_form_only_initial_values_parameter_is_allowed",DidLongFormOnlyOneQueryParamAllowed:"did_long_form_only_one_query_param_allowed",DidNoUniqueSuffix:"did_no_unique_suffix",DidUniqueSuffixFromInitialStateMismatch:"did_unique_suffix_from_initial_state_mismatch",DocumentComposerDocumentMissing:"document_composer_document_missing",DocumentComposerIdNotString:"document_composer_id_not_string",DocumentComposerIdNotUsingBase64UrlCharacterSet:"document_composer_id_not_using_base_64_url_character_set",DocumentComposerIdTooLong:"document_composer_id_too_long",DocumentComposerInvalidSignature:"document_composer_invalid_signature",DocumentComposerPatchMissingOrUnknownAction:"document_composer_patch_missing_or_unknown_action",DocumentComposerPatchMissingOrUnknownProperty:"document_composer_patch_missing_or_unknown_property",DocumentComposerPatchPublicKeyIdNotString:"document_composer_patch_public_key_id_not_string",DocumentComposerPatchPublicKeyIdsNotArray:"document_composer_patch_public_keys_ids_not_array",DocumentComposerPatchServiceEndpointNotString:"document_composer_patch_service_endpoint_not_string",DocumentComposerPatchServiceEndpointsNotArray:"document_composer_patch_service_endpoints_not_array",DocumentComposerPatchServiceTypeMissingOrUnknown:"document_composer_patch_service_type_missing_or_unknown",DocumentComposerPublicKeyIdDuplicated:"document_composer_public_key_id_duplicated",DocumentComposerPublicKeyJwkMissingOrIncorrectType:"document_composer_public_key_jwk_missing_or_incorrect_type",DocumentComposerPublicKeyMissingOrUnknownProperty:"document_composer_public_key_missing_or_unknown_property",DocumentComposerPublicKeysNotArray:"document_composer_public_keys_not_array",DocumentComposerPublicKeyTypeMissingOrIncorrectType:"document_composer_public_key_type_missing_or_incorrect_type",DocumentComposerPublicKeyPurposeMissingOrUnknown:"document_composer_public_key_purpose_missing_or_unknown",DocumentComposerPublicKeyPurposeExceedsMaxLength:"document_composer_public_key_purpose_exceeds_max_length",DocumentComposerPublicKeyInvalidPurpose:"document_composer_public_key_invalid_purpose",DocumentComposerPatchServiceEndpointIdsNotArray:"document_composer_service_endpoint_ids_not_array",DocumentComposerPatchServiceEndpointServiceEndpointNotString:"document_composer_service_endpoint_service_endpoint_not_string",DocumentComposerPatchServiceEndpointServiceEndpointNotValidUrl:"document_composer_service_endpoint_service_endpoint_not_valid_url",DocumentComposerPatchServiceEndpointServiceEndpointTooLong:"document_composer_service_endpoint_service_endpoint_too_long",DocumentComposerPatchServiceEndpointTypeNotString:"document_composer_service_endpoint_type_not_string",DocumentComposerPatchServiceEndpointTypeTooLong:"document_composer_service_endpoint_type_too_long",DocumentComposerServiceEndpointMissingOrUnknownProperty:"document_composer_service_endpoint_missing_or_unknown_property",DocumentComposerServiceNotArray:"document_composer_service_not_array",DocumentComposerUnknownPropertyInDocument:"document_composer_unknown_property_in_document",DocumentComposerUpdateOperationDocumentPatchesNotArray:"document_composer_update_operation_document_patch_not_array",DocumentIncorretEncodedFormat:"document_incorrect_encoded_format",DocumentNotJson:"document_not_json",DocumentNotValidOriginalDocument:"document_not_valid_original_document",EncoderValidateBase64UrlStringInputNotBase64UrlString:"encoder_validate_base64url_string_input_not_base64url_string",EncoderValidateBase64UrlStringInputNotString:"encoder_validate_base64url_string_input_not_string",JwkHasUnknownProperty:"jwk_has_unknown_property",JwkMissingOrInvalidCrv:"jwk_missing_or_invalid_crv",JwkMissingOrInvalidKty:"jwk_missing_or_invalid_kty",JwkMissingOrInvalidTypeX:"jwk_missing_or_invalid_type_x",JwkMissingOrInvalidTypeY:"jwk_missing_or_invalid_type_y",JwkUndefined:"jwk_undefined",JwsCompactJwsInvalid:"jws_compact_jws_invalid",JwsCompactJwsNotString:"jws_compact_jws_not_string",JwsFailedSignatureValidation:"jws_failed_signature_validation",JwsPayloadNotBase64UrlString:"jws_payload_not_base64url_string",JwsProtectedHeaderMissingOrIncorrectAlg:"jws_protected_header_missing_or_incorrect_alg",JwsProtectedHeaderMissingOrUnknownProperty:"jws_protected_header_missing_or_unknown_property",JwsSignatureNotBase64UrlString:"jws_signature_not_base64url_string",MapFileChunkHasMissingOrUnknownProperty:"map_file_chunk_has_missing_or_unknown_property",MapFileChunksPropertyDoesNotHaveExactlyOneElement:"map_file_chunks_property_does_not_have_exactly_one_element",MapFileChunksPropertyMissingOrIncorrectType:"map_file_chunks_property_missing_or_incorrect_type",MapFileDecompressionFailure:"map_file_decompression_failure",MapFileHasUnknownProperty:"map_file_has_unknown_property",MapFileMultipleOperationsForTheSameDid:"map_file_multiple_operations_for_the_same_did",MapFileNotJson:"map_file_not_json",MapFileOperationsPropertyHasMissingOrUnknownProperty:"map_file_operations_property_has_missing_or_unknown_property",MapFileUpdateOperationsNotArray:"map_file_update_operations_not_array",MultihashNotLatestSupportedHashAlgorithm:"multihash_not_latest_supported_hash_algorithm",MultihashUnsupportedHashAlgorithm:"multihash_unsupported_hash_algorithm",OperationCreateInvalidDidDocument:"operation_create_invalid_did_document",OperationCountLessThanZero:"operation_count_less_than_zero",OperationCreatePayloadHasMissingOrInvalidNextRecoveryCommitment:"operation_create_payload_has_missing_or_invalid_next_recovery_commitment",OperationCreatePayloadHasMissingOrInvalidNextUpdateCommitment:"operation_create_payload_has_missing_or_invalid_next_update_commitment",OperationCreatePayloadMissingOrUnknownProperty:"operation_create_payload_missing_or_unknown_property",OperationDocumentPatchesMissing:"operation_document_patches_missing",OperationPayloadMissingOrIncorrectType:"operation_payload_missing_or_incorrect_type",OperationProcessorCreateOperationDoesNotHaveRevealValue:"operation_processor_create_operation_does_not_have_reveal_value",OperationProcessorUnknownOperationType:"operation_processor_unknown_operation_type",OperationTypeUnknownOrMissing:"operation_type_unknown_or_missing",QueueingMultipleOperationsPerDidNotAllowed:"queueing_multiple_operations_per_did_not_allowed",RecoverOperationMissingOrInvalidDidUniqueSuffix:"recover_operation_missing_or_invalid_did_unique_suffix",RecoverOperationMissingOrUnknownProperty:"recover_operation_missing_or_unknown_property",RecoverOperationSignedDataMissingOrUnknownProperty:"recover_operation_signed_data_missing_or_unknown_property",RecoverOperationTypeIncorrect:"recover_operation_type_incorrect",RequestHandlerDeltaExceedsMaximumSize:"request_handler_patch_data_exceeds_maximum_size",RequestHandlerUnknownOperationType:"request_handler_unknown_operation_type",DeactivateOperationMissingOrInvalidDidUniqueSuffix:"deactivate_operation_missing_or_invalid_did_unique_suffix",DeactivateOperationMissingOrUnknownProperty:"deactivate_operation_missing_or_unknown_property",DeactivateOperationSignedDataMissingOrUnknownProperty:"deactivate_operation_signed_data_missing_or_unknown_property",DeactivateOperationSignedDidUniqueSuffixMismatch:"deactivate_operation_signed_did_unique_suffix_mismatch",DeactivateOperationTypeIncorrect:"deactivate_operation_type_incorrect",TransactionFeePaidInvalid:"transaction_fee_paid_is_invalid",TransactionFeePaidLessThanNormalizedFee:"transaction_fee_paid_less_than_normalized_fee",TransactionProcessorPaidOperationCountExceedsLimit:"transaction_processor_paid_operation_count_exceeds_limit",TransactionsNotInSameBlock:"transactions_not_in_same_block",UpdateOperationMissingDidUniqueSuffix:"update_operation_missing_did_unique_suffix",UpdateOperationMissingOrUnknownProperty:"update_operation_missing_or_unknown_property",UpdateOperationSignedDataHasMissingOrUnknownProperty:"update_operation_signed_data_has_missing_or_unknown_property",UpdateOperationTypeIncorrect:"update_operation_type_incorrect",ValueTimeLockVerifierInvalidNumberOfOperations:"value_time_lock_verifierInvalid_number_of_operations",ValueTimeLockVerifierTransactionTimeOutsideLockRange:"value_time_lock_verifiertarget_transaction_time_outside_lock_range",ValueTimeLockVerifierTransactionWriterLockOwnerMismatch:"value_time_lock_verifiertransaction_owner_lock_writer_mismatch"};function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,o){return(h=Object.setPrototypeOf||function(e,o){return e.__proto__=o,e})(e,o)}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function g(e,o,n){return(g=f()?Reflect.construct:function(e,o,n){var r=[null];r.push.apply(r,o);var t=new(Function.bind.apply(e,r));return n&&h(t,n.prototype),t}).apply(null,arguments)}function y(e){var o="function"==typeof Map?new Map:void 0;return(y=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==o){if(o.has(e))return o.get(e);o.set(e,n)}function n(){return g(e,arguments,m(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),h(n,e)})(e)}var v=function(e){var o,n;function r(o,n){var t;return(t=e.call(this,n?o+": "+n:o)||this).code=o,Object.setPrototypeOf(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t),(this instanceof r?this.constructor:void 0).prototype),t}return n=e,(o=r).prototype=Object.create(n.prototype),o.prototype.constructor=o,o.__proto__=n,r.createFromError=function(e,o){return new r(e,o?o.message:void 0)},r.stringify=function(e){return JSON.stringify(e,Object.getOwnPropertyNames(e))},r}(y(Error)),k={hashAlgorithmInMultihashCode:18,maxAnchorFileSizeInBytes:1e6,maxChunkFileSizeInBytes:2e7,maxDeltaSizeInBytes:1e3,maxMapFileSizeInBytes:1e6,maxNumberOfOperationsForNoValueTimeLock:100,maxNumberOfOperationsPerTransactionTime:6e5,maxNumberOfTransactionsPerTransactionTime:300,maxOperationsPerBatch:1e4,normalizedFeeToPerOperationFeeMultiplier:.01,valueTimeLockAmountMultiplier:600},O=function(){function e(){}return e.serialize=function(o){return""+o.numberOfOperations+e.delimiter+o.anchorFileHash},e.deserialize=function(o){var n=o.split(e.delimiter);if(2!==n.length)throw new v(l.AnchoredDataIncorrectFormat,"Input is not in correct format: "+o);var r=e.parsePositiveInteger(n[0]);if(r>k.maxOperationsPerBatch)throw new v(l.AnchoredDataNumberOfOperationsGreaterThanMax,"Number of operations "+r+" must be less than or equal to "+k.maxOperationsPerBatch);return{anchorFileHash:n[1],numberOfOperations:r}},e.parsePositiveInteger=function(e){if(!/^[1-9]\d*$/.test(e))throw new v(l.AnchoredDataNumberOfOperationsNotPositiveInteger,"Number of operations '"+e+"' is not a positive integer without leading zeros.");return Number(e)},e}();O.delimiter=".";var w=function(){function e(){}return e.encode=function(e){return n.encode(e)},e.decodeAsBuffer=function(o){return e.validateBase64UrlString(o),n.toBuffer(o)},e.decodeAsString=function(o){return e.decodeBase64UrlAsString(o)},e.decodeBase64UrlAsString=function(o){return e.validateBase64UrlString(o),n.decode(o)},e.validateBase64UrlString=function(o){if("string"!=typeof o)throw new v(l.EncoderValidateBase64UrlStringInputNotString,"Input '"+o+"' not a string.");if(!e.isBase64UrlString(o))throw new v(l.EncoderValidateBase64UrlStringInputNotBase64UrlString,"Input '"+o+"' not a Base64URL string.")},e.isBase64UrlString=function(e){return/^[A-Za-z0-9_-]+$/.test(e)},e}(),P=require("canonicalize"),S=function(){function e(){}return e.canonicalizeAsBuffer=function(e){var o=P(e);return Buffer.from(o)},e}(),D=require("multihashes"),M=function(){function e(){}return e.hash=function(e,o){var n;switch(void 0===o&&(o=k.hashAlgorithmInMultihashCode),o){case 18:n=r.createHash("sha256").update(e).digest();break;default:throw new v(l.MultihashUnsupportedHashAlgorithm)}return D.encode(n,D.codes[o])},e.canonicalizeThenHashThenEncode=function(o){var n=S.canonicalizeAsBuffer(o);return e.hashThenEncode(n,k.hashAlgorithmInMultihashCode)},e.hashThenEncode=function(o,n){var r=e.hash(o,n);return w.encode(r)},e.getHashAlgorithmCode=function(e){var o=D.decode(e);if(18!==o.code)throw new v(l.MultihashUnsupportedHashAlgorithm);return o.code},e.verifyHashComputedUsingLatestSupportedAlgorithm=function(o){if(!e.isComputedUsingHashAlgorithm(o,18))throw new v(l.MultihashNotLatestSupportedHashAlgorithm)},e.isComputedUsingHashAlgorithm=function(e,o){try{return D.decode(e).code===o}catch(e){return!1}},e.isValidHash=function(o,n){if(void 0===o)return!1;try{var r=w.decodeAsBuffer(o);return e.verify(r,n)}catch(e){return console.log(e),!1}},e.canonicalizeAndVerify=function(o,n){if(void 0===o)return!1;try{var r=S.canonicalizeAsBuffer(o);return e.verify(r,n)}catch(e){return console.log(e),!1}},e.verify=function(o,n){try{var r=w.decodeAsBuffer(n),t=e.getHashAlgorithmCode(r),i=e.hash(o,t);return 0===Buffer.compare(i,r)}catch(e){return console.log(e),!1}},e}(),b=function(){function e(){}return e.readAll=function(e){try{var o=Buffer.alloc(0);e.on("readable",(function(){for(var n=e.read();null!==n;)o=Buffer.concat([o,n]),n=e.read()}));var n=new Promise((function(o,n){e.on("end",o),e.on("error",n)}));return Promise.resolve(n).then((function(){return o}))}catch(e){return Promise.reject(e)}},e}(),N=function(){function e(){}return e.binarySearch=function(e,o,n){for(var r=0,t=e.length-1,i=0;r<=t;){var a=n(e[i=Math.floor((r+t)/2)],o);if(a>0)t=i-1;else{if(!(a<0))return i;r=i+1}}},e}();exports.AbstractVersionMetadata=function(){},exports.AnchoredDataSerializer=O,exports.CoreErrorCode={BlockchainGetFeeResponseNotOk:"blockchain_get_fee_response_not_ok",BlockchainGetLatestTimeResponseNotOk:"blockchain_get_latest_time_response_not_ok",BlockchainGetLockResponseNotOk:"blockchain_get_lock_response_not_ok",BlockchainGetWriterLockResponseNotOk:"blockchain_get_writer_lock_response_not_ok",BlockchainReadInvalidArguments:"blockchain_read_invalid_arguments",BlockchainReadResponseNotOk:"blockchain_read_response_not_ok",BlockchainWriteResponseNotOk:"blockchain_write_response_not_ok",VersionManagerBatchWriterNotFound:"version_manager_batch_writer_not_found",VersionManagerDocumentComposerNotFound:"version_manager_document_composer_not_found",VersionManagerOperationProcessorNotFound:"version_manager_operation_processor_not_found",VersionManagerRequestHandlerNotFound:"version_manager_request_handler_not_found",VersionManagerTransactionProcessorNotFound:"version_manager_transaction_processor_not_found",VersionManagerTransactionSelectorNotFound:"version_manager_transaction_selector_not_found",VersionManagerVersionStringNotFound:"version_manager_version_string_not_found",VersionManagerVersionMetadataIncorrectType:"version_manager_version_metadata_incorrect_type"},exports.Encoder=w,exports.ErrorCode=l,exports.FetchResultCode=i,exports.JsonCanonicalizer=S,exports.Multihash=M,exports.OperationType=_,exports.PublicKeyPurpose=c,exports.ReadableStream=b,exports.ResponseStatus=u,exports.SharedErrorCode={BlockchainTimeOutOfRange:"blockchain_time_out_of_range",InvalidTransactionNumberOrTimeHash:"invalid_transaction_number_or_time_hash",NotEnoughBalanceForWrite:"not_enough_balace_for_write",SpendingCapPerPeriodReached:"spending_cap_per_period_reached",ValueTimeLockNotFound:"value_time_lock_not_found"},exports.SidetreeError=v,exports.SortedArray=N,exports.TransactionProcessingStatus=d,exports.protocolParameters=k;
//# sourceMappingURL=common.cjs.production.min.js.map
